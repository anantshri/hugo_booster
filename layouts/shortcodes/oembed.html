<!-- Initial Code from a hugo forum -->
{{ $url := .Get "url" }}
{{ $out := "" }}
{{ $size := "&maxwidth=450&maxheight=250" }}
{{ $frame_prop := "iframe loading='lazy' style='position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;' " }}
{{ $embedURL := urls.Parse $url }}


{{ if ( findRE "(youtu)" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://www.youtube.com/oembed?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: 55.25%; height: 0; overflow: hidden;">
    {{ with $oembed.html }}
      {{ replace . "iframe " $frame  | safeHTML }}
    {{ end }}
  </div>
{{ else if ( findRE "(vimeo)" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://vimeo.com/api/oembed.json?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: 55.25%; height: 0; overflow: hidden;">
    {{ with $oembed.html }}
      {{ replace . "iframe " $frame   | safeHTML }}
    {{ end }}
  </div>
{{ else if ( findRE "(slideshare)" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://www.slideshare.net/api/oembed/2?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: 55.25%; height: 0; overflow: hidden;">
    {{ with $oembed.html }}
      {{ replace . "iframe " $frame  | replaceRE "<div(.*)</div>" "" | safeHTML }}
    {{ end }}
  </div>
{{ else if ( findRE "spotify" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://open.spotify.com/oembed?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: {{ $oembed.height  }}px; height: 0; overflow: hidden;">
  {{ with $oembed.html }}
    {{ replace . "iframe " $frame   | safeHTML }}
  {{ end }}
  </div>
{{ else if ( findRE "spreaker" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://api.spreaker.com/oembed?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: {{ $oembed.height  }}px; height: 0; overflow: hidden;">
  {{ with $oembed.html }}
    {{ replace . "iframe " $frame   | safeHTML }}
  {{ end }}
  </div>
{{ else if ( findRE "speakerdeck" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://speakerdeck.com/oembed.json?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: 55.25%; height: 0; overflow: hidden;">
  {{ with $oembed.html }}
    {{ replace . "iframe " $frame   | safeHTML }}
  {{ end }}
  </div>
{{ else if ( findRE "twitter" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://publish.twitter.com/oembed?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  {{ with $oembed.html }}
    {{ replace . "iframe " $frame | replaceRE "<script(.*)</script>" ""  | safeHTML }}
  {{ end }}
{{ else if ( findRE "codesandbox" $embedURL.Host 1 ) }}
  {{ $oembed := getJSON "https://codesandbox.io/oembed?url=" $url $size }}
  {{ $frame := printf "title='%s' " $oembed.title | printf "%s%s" $frame_prop  }}
  <div style="position: relative; padding-bottom: 55.25%; height: 0; overflow: hidden;">
  {{ with $oembed.html }}
    {{ replace . "iframe " $frame | replaceRE "<script(.*)</script>" ""  | safeHTML }}
  {{ end }}
</div>
{{ else }}
<h1> I dont Know how to embed this URL</h1>
<a href="$url">{{ $url }}</a>
{{ end }}